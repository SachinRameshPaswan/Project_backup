<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign Up | Connect & Found</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    
    <style> body { font-family: "Inter", sans-serif; } </style>
</head>

<body class="bg-slate-900 min-h-screen flex items-center justify-center p-6 text-white">

    <div class="bg-slate-800 p-8 rounded-2xl shadow-2xl w-full max-w-md border border-slate-700">

        <div class="text-center mb-8">
            <h1 class="text-3xl font-extrabold text-indigo-500">Create Account</h1>
            <p class="text-slate-400 mt-2">Join Connect & Found</p>
        </div>

<form id="signup-form" class="space-y-4">
    
    <div>
        <label class="block text-sm font-medium text-slate-300 mb-1">I am a:</label>
        <select id="user_type" onchange="toggleFormLabels()" class="w-full p-3 bg-slate-800 border border-slate-600 rounded-xl text-white outline-none focus:ring-2 focus:ring-indigo-500">
            <option value="student">Student</option>
            <option value="faculty">Faculty / Teaching Staff</option>
            <option value="staff">Other Staff (Security/Cleaning/Admin)</option>
        </select>
    </div>

    <div>
        <label class="block text-sm font-medium text-slate-300 mb-1">Full Name</label>
        <input type="text" id="fullname" required class="w-full p-3 bg-slate-700 border border-slate-600 rounded-xl text-white outline-none focus:ring-2 focus:ring-indigo-500" placeholder="e.g. Rahul Sharma">
    </div>

    <div class="grid grid-cols-2 gap-4">
        <div>
            <label id="label-id" class="block text-sm font-medium text-slate-300 mb-1">College ID</label>
            <input type="text" id="college_id" required class="w-full p-3 bg-slate-700 border border-slate-600 rounded-xl text-white outline-none" placeholder="ID Number">
        </div>
        <div>
            <label class="block text-sm font-medium text-slate-300 mb-1">Mobile (Private)</label>
            <input type="tel" id="contact_no" required class="w-full p-3 bg-slate-700 border border-slate-600 rounded-xl text-white outline-none" placeholder="Contact No">
        </div>
    </div>

    <div>
        <label id="label-dept" class="block text-sm font-medium text-slate-300 mb-1">Course / Department</label>
        <input type="text" id="course" required class="w-full p-3 bg-slate-700 border border-slate-600 rounded-xl text-white outline-none" placeholder="e.g. B.Sc CS or Housekeeping">
    </div>

    <div>
        <label id="label-details" class="block text-sm font-medium text-slate-300 mb-1">Class & Roll No / Designation</label>
        <input type="text" id="class_details" required class="w-full p-3 bg-slate-700 border border-slate-600 rounded-xl text-white outline-none" placeholder="e.g. FY-A-45 or Senior Security">
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
            <label class="block text-sm font-medium text-slate-300 mb-1">Email</label>
            <input type="email" id="email" required class="w-full p-3 bg-slate-700 border border-slate-600 rounded-xl text-white outline-none" placeholder="you@college.edu">
        </div>
        <div>
            <label class="block text-sm font-medium text-slate-300 mb-1">Password</label>
           <div class="relative">
    <input type="password" id="password" required
        class="w-full p-3 pr-10 bg-slate-700 border border-slate-600 rounded-xl text-white outline-none"
        placeholder="••••••••">

    <button type="button" id="toggle-password"
        class="absolute inset-y-0 right-0 flex items-center pr-3 text-slate-400 hover:text-indigo-400">

        <i id="eye-icon" class="ph-bold ph-eye-slash text-xl"></i>

    </button>
</div>

        </div>
    </div>

    <div class="flex items-center gap-3 mb-4 p-3 bg-slate-800/50 border border-slate-600 rounded-xl">
        <input type="checkbox" id="request-admin" class="w-5 h-5 text-indigo-600 rounded border-slate-500 bg-slate-700 focus:ring-indigo-500">
        <label for="request-admin" class="text-sm font-medium text-slate-300">
            Request Admin Privileges <span class="block text-xs text-slate-400 font-normal">(Requires Super Admin Approval)</span>
        </label>
    </div>
    
<button type="submit" id="signup-btn" class="w-full bg-indigo-600 text-white font-bold py-3.5 rounded-xl hover:bg-indigo-700 transition shadow-lg shadow-indigo-900/50">
        Register with Connect & Found
    </button>

    <div class="mt-6 text-center border-t border-slate-700 pt-4">
        <p class="text-sm text-slate-400">
            Already have an account? 
            <a href="login.html" class="text-indigo-400 font-bold hover:text-indigo-300 transition hover:underline">
                Log In
            </a>
        </p>
    </div>
</form>
    </div>

    <script src="config.js"></script>
    <script type="module" src="supabase.js"></script>

    <script type="module">
    import { supabase } from './supabase.js';
    import { handleSignup } from './auth.js';

    // Dynamic UI Toggling
    window.toggleFormLabels = function() {
        const type = document.getElementById('user_type').value;
        const labelId = document.getElementById('label-id');
        const labelDept = document.getElementById('label-dept');
        const labelDetails = document.getElementById('label-details');
        const inputDept = document.getElementById('course');
        const inputDetails = document.getElementById('class_details');

        if (type === 'student') {
            labelId.innerText = "Student ID";
            labelDept.innerText = "Course Name";
            labelDetails.innerText = "Class, Div & Roll No";
            inputDept.placeholder = "e.g. B.Sc CS";
            inputDetails.placeholder = "e.g. FY - Div A - Roll 45";
        } else if (type === 'faculty') {
            labelId.innerText = "Employee ID";
            labelDept.innerText = "Department";
            labelDetails.innerText = "Designation";
            inputDept.placeholder = "e.g. Information Technology";
            inputDetails.placeholder = "e.g. Assistant Professor";
        } else {
            labelId.innerText = "Staff ID";
            labelDept.innerText = "Work Area";
            labelDetails.innerText = "Role";
            inputDept.placeholder = "e.g. Canteen or Maintenance";
            inputDetails.placeholder = "e.g. Supervisor";
        }
    };

    // Password Visibility Toggle
    const toggleBtn = document.getElementById("toggle-password");
    if (toggleBtn) {
        toggleBtn.addEventListener("click", () => {
            const pass = document.getElementById("password");
            const eye = document.getElementById("eye-icon");
            if (pass.type === "password") {
                pass.type = "text";
                eye.classList.replace("ph-eye-slash", "ph-eye");
            } else {
                pass.type = "password";
                eye.classList.replace("ph-eye", "ph-eye-slash");
            }
        });
    }

    // Attach centralized signup logic
    document.getElementById('signup-form').addEventListener('submit', handleSignup);
</script>
</body>
</html>